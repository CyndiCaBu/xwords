<!DOCTYPE html>
<html>
<head>
	<!-- Standard Meta -->
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

	<!-- Site Properties -->
	<title>X-Words Grammar</title>

	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/reset.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/site.css">

	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/container.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/grid.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/header.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/image.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/menu.css">

	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/divider.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/list.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/segment.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/dropdown.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/icon.css">
	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/components/transition.css">

	<link rel="stylesheet" type="text/css" href="../libs/Semantic-UI-CSS/semantic.min.css">
	<link rel="stylesheet" type="text/css" href="../style/main.css">
	<link rel="stylesheet" type="text/css" href="../style/xwords.css">

	<script src="../libs/jquery.min.js" ></script>
	<script src="../libs/Semantic-UI-CSS/semantic.min.js"></script>
	<script src="../libs/list.js"></script>

	<script src="../libs/Semantic-UI-CSS/components/transition.js"></script>
	<script src="../libs/Semantic-UI-CSS/components/dropdown.js"></script>
	<script src="../libs/Semantic-UI-CSS/components/visibility.js"></script>
	<script>
	$(document)
		.ready(function() {

			// fix main menu to page on passing
			$('.main.menu').visibility({
				type: 'fixed'
			});
			$('.overlay').visibility({
				type: 'fixed',
				offset: 80
			});

			// lazy load images
			$('.image').visibility({
				type: 'image',
				transition: 'vertical flip in',
				duration: 500
			});

			// show dropdown on hover
			$('.main.menu	.ui.dropdown').dropdown({
				on: 'hover'
			});
		})
	;
	</script>

	<style type="text/css">

	body {
		background-color: #FFFFFF;
	}
	.main.container {
		margin-top: 2em;
	}

	.main.menu {
		margin-top: 4em;
		border-radius: 0;
		border: none;
		box-shadow: none;
		transition:
			box-shadow 0.5s ease,
			padding 0.5s ease
		;
	}
	.main.menu .item img.logo {
		margin-right: 1.5em;
	}

	.overlay {
		float: left;
		margin: 0em 3em 1em 0em;
	}
	.overlay .menu {
		position: relative;
		left: 0;
		transition: left 0.5s ease;
	}

	.main.menu.fixed {
		background-color: #FFFFFF;
		border: 1px solid #DDD;
		box-shadow: 0px 3px 5px rgba(0, 0, 0, 0.2);
	}
	.overlay.fixed .menu {
		left: 800px;
	}

	.text.container .left.floated.image {
		margin: 2em 2em 2em -4em;
	}
	.text.container .right.floated.image {
		margin: 2em -4em 2em 2em;
	}

	.ui.footer.segment {
		margin: 5em 0em 0em;
		padding: 5em 0em;
	}

	.xw-verb {
		border-bottom: 1px dashed #F00;
	}
	.xw-hidden-does {
		border-bottom: 1px dashed #FF0;
	}
	.xw-hidden-did {
		border-bottom: 1px dashed #0FF;
	}
	.xw-found {
		background-color: #0F0;
	}

	</style>

</head>
<body>

	<div class="ui main text container">
		<h1 class="ui header" id="article-title"></h1>
		<img id="article-image" class="ui centered medium image" src="">
	</div>


	<div class="ui borderless main menu">
		<div class="ui text container">
			<div href="#" class="header item">
				<img id="article-icon" class="logo" src="">
			</div>

			<a href="../x-words" class="ui dropdown item">
				Find the Verbs (<div><span id="x-words-found"></span>/<span id="x-words-total"></span></div>)
				<i class="dropdown icon"></i>
				<div class="menu">
					<div class="item">Verbs and X-Words</div>
					<div class="item">Hidden X-Words</div>
					<div class="item">Subjects and X-Words</div>
					<div class="item">Verbs</div>
					<div class="item">Sentence Patterns</div>
					<div class="divider"></div>
					<div class="header">Help</div>
					<div class="item">
						<i class="dropdown icon"></i>
						What are X-Words
						<div class="menu">
							<div class="item">Blah blah</div>
							<div class="item">Bloopity Bloop Bleep</div>
						</div>
					</div>
					<div class="item">Hints</div>
				</div>
			</a>

			<span class="item divider">/</span>
			<a class="item" id="breadcrumb-category" class="section"></a>
			<span class="item divider">/</span>
			<div class="item" id="breadcrumb-article" class="active section"></div>
		</div>
	</div>

	<div class="ui text container">
		<div class="x-words-content">
			
			<!-- put stuff here -->
			
		</div>
		<p></p>
	</div>

	<div class="ui inverted vertical footer segment">
		<div class="ui center aligned container">
			<div class="ui stackable inverted divided grid">
				<div class="three wide column">
					<h4 class="ui inverted header">Group 1</h4>
					<div class="ui inverted link list">
						<a href="#" class="item">Link One</a>
						<a href="#" class="item">Link Two</a>
						<a href="#" class="item">Link Three</a>
						<a href="#" class="item">Link Four</a>
					</div>
				</div>
				<div class="three wide column">
					<h4 class="ui inverted header">Group 2</h4>
					<div class="ui inverted link list">
						<a href="#" class="item">Link One</a>
						<a href="#" class="item">Link Two</a>
						<a href="#" class="item">Link Three</a>
						<a href="#" class="item">Link Four</a>
					</div>
				</div>
				<div class="three wide column">
					<h4 class="ui inverted header">Group 3</h4>
					<div class="ui inverted link list">
						<a href="#" class="item">Link One</a>
						<a href="#" class="item">Link Two</a>
						<a href="#" class="item">Link Three</a>
						<a href="#" class="item">Link Four</a>
					</div>
				</div>
				<div class="seven wide column">
					<h4 class="ui inverted header">Footer Header</h4>
					<p>Extra space for a call to action inside the footer that could help re-engage users.</p>
				</div>
			</div>
			<div class="ui inverted section divider"></div>
			<img src="assets/images/logo.png" class="ui centered mini image">
			<div class="ui horizontal inverted small divided link list">
				<a class="item" href="#">Site Map</a>
				<a class="item" href="#">Contact Us</a>
				<a class="item" href="#">Terms and Conditions</a>
				<a class="item" href="#">Privacy Policy</a>
			</div>
		</div>
	</div>

	<!--
	<script type="text/javascript" src="../js/x-words.js"></script>
	<script type="text/javascript" src="../js/main-verbs.js"></script>
	-->

<script>

function markup_xwords(){
}

var tokens = {
	'subject': '<span class="subject">|</span>',
	's': '<span class="subject">|</span>',
	
	'vxo': '<span class="hidden-do">|</span>',
	'hidden do': '<span class="hidden-do">|</span>',
	
	'vxs': '<span class="hidden-does">|</span>',
	'hidden does': '<span class="hidden-does">|</span>',
	
	'vxd': '<span class="hidden-did">|</span>',
	'hidden did': '<span class="hidden-did">|</span>',
	
	'inf': '<span class="infinitive">|</span>',
	'infinitive': '<span class="infinitive">|</span>',
	
	'dtn': '<span class="past-participle">|</span>',
	'past participle': '<span class="past-participle">|</span>',
	
	'extra': '<span class="extra-information">|</span>',
	'extra info': '<span class="extra-information">|</span>',
	
	'v': '<span class="verb">|</span>',
	'verb': '<span class="verb">|</span>',
	
	'x': '<span class="xword">|</span>',
	'xwords': '<span class="xwords">|</span>',
	
	's': '<span class="subject">|</span>',
	'subject': '<span class="subject">|</span>',
	
	't': '<span class="trunk">|</span>',
	'trunk': '<span class="trunk">|</span>',
	
	'l': '<span class="linker">|</span>',
	'linker': '<span class="linker">|</span>',
	
	'j': '<span class="joiner">|</span>',
	'joiner': '<span class="joiner">|</span>',
	
	'sh': '<span class="shifter">|</span>',
	'shifter': '<span class="shifter">|</span>',
	
	'f': '<span class="front-shifter">|</span>',
	'front shifter': '<span class="front-shifter">|</span>',
	
	'e': '<span class="end-shifter">|</span>',
	'end shifter': '<span class="end-shifter">|</span>'
};

function parse_text( text, tokens ){

	var replace_function = function(match, text, identifier, offset, string){
		if( ! tokens.hasOwnProperty( identifier ) ){
			throw ('Identifier: ['+identifier+'] is unknown. (TODO: add list of valid identifiers)');
		}
		
		return tokens[identifier].replace('|',text);
	};

	var single_word_regexp = /(\w+?)\[(.+?)\]/g;
	var parenthetical_regexp = /\((.+?)\)\[(.+?)\]/g;
	var curly_bracket_regexp = /\{(.+?)\}\[(.+?)\]/g;
	var regexps = [
		single_word_regexp,
		parenthetical_regexp,
		curly_bracket_regexp
	];
	
	var output = text;
	for( var i=0, l=regexps.length; i<l; i+=1 ){
		output = output.replace( regexps[i], replace_function );
	}
	
	return output;
}

function make_bold( text ){
	// Single word
	var single_word_regexp = /(\w+?)\[(.+?)\]/g;
	var parenthetical_regexp = /\((.+?)\)\[(.+?)\]/g;
	var output = text;
	output = output.replace( single_word_regexp, function(match, text, identifier, offset, string){
		return '<span class="'+identifier+'">'+text+'</span>';
	});
	output= output.replace( parenthetical_regexp, function(match, text, identifier, offset, string){
		return '<span class="'+identifier+'">'+text+'</span>';
	});
	return output;
	
}

console.info( parse_text( 'I[s] am[v] happy', tokens ) );
console.info( parse_text( '{(The very tall girl)[subject] has[x] eaten[v] an apple}[t]', tokens ) );
console.info( parse_text( '{(The very tall girl)[subject] has[x] eaten[v] an apple}[t] {and}[l] {(another girl)[s] makes[hidden-does] a pie}[t].', tokens ) );

console.info( make_bold( 'hello world[bold]! This is great[bold] stuff.' ) );
console.info( make_bold( '(hello world!)[bold] This is great[bold] stuff.' ) );

</script>

</body>

</html>
